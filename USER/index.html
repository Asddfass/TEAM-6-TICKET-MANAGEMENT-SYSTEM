<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Hamburger Button -->
            <button type="button" class="hamburger-button d-md-none" aria-label="Toggle navigation menu" aria-controls="sidebarNav" aria-expanded="false">
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
            </button>
    
    <title>Faculty Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="CSS/userStyle.css">
</head>
<body>
    <!-- Dashboard Container -->
    <div class="dashboard-container d-flex">
        <!-- Sidebar Navigation -->
        <nav class="sidebar vh-100 p-3 d-flex flex-column justify-content-between">
            <!-- Top Navigation Links -->
            <div>
                <ul class="nav nav-pills flex-column mt-4">
                    <li class="nav-item">
                        <a href="#home-section" class="nav-link active" aria-current="page">
                            <i class="fas fa-home me-2"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#request-section" class="nav-link">
                            <i class="fas fa-file-alt me-2"></i>
                            <span>Request</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#status-section" class="nav-link">
                            <i class="fas fa-hourglass-half me-2"></i>
                            <span>Status</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#history-section" class="nav-link">
                            <i class="fas fa-history me-2"></i>
                            <span>History</span>
                        </a>
                    </li>
                    <!-- Settings Link -->
                    <li class="nav-item">
                        <a href="#settings-section" class="nav-link">
                            <i class="fas fa-cog me-2"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </div>
            <!-- Logout -->
            <div>
                 <div class="logout-section">
                     <a href="#index.html" id="logout-link" class="nav-link">
                        <i class="fas fa-sign-out-alt me-2"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <div class="main-content flex-grow-1">
             <!-- Header -->
             <header class="header d-flex justify-content-between align-items-center p-3 shadow-sm">
                <h4 class="mb-0">Faculty Dashboard</h4>
                <div class="header-icons d-flex align-items-center">
                    <a href="#" class="text-decoration-none text-secondary" id="profile-icon-link" title="View Profile">
                        <i class="fas fa-user-circle fs-5"></i>
                    </a>
                </div>
            </header>

            <div class="content-area p-4">

                <!-- HOME SECTION -->
                <div class="content-section" id="home-section">
                    <h5 class="mb-4">Home</h5>
                    <div class="row g-3 mb-4">
                        <div class="col-lg-4 col-md-6">
                            <div class="info-box info-box-pending h-100">
                                <div class="info-box-content">
                                    <span class="info-box-text">Pending Request</span>
                                    <span class="info-box-number" id="pending-count">0</span>
                                    <a href="#status-section" class="view-link internal-nav">View All Requests</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6">
                             <div class="info-box info-box-approved h-100">
                                <div class="info-box-content">
                                    <span class="info-box-text">Approved Request</span>
                                    <span class="info-box-number" id="approved-count">0</span>
                                    <a href="#status-section" class="view-link internal-nav">View All Requests</a>
                                </div>
                            </div>
                        </div>
                         <div class="col-lg-4 col-md-6">
                            <div class="info-box info-box-progress h-100">
                                <div class="info-box-content">
                                    <span class="info-box-text">In Progress</span>
                                    <span class="info-box-number" id="progress-count">0</span>
                                    <a href="#status-section" class="view-link internal-nav">View All Requests</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card notification-card">
                        <div class="card-body">
                            <h5 class="card-title mb-3"><i class="fas fa-bell me-2"></i>Notifications</h5>
                            <div id="notification-content">
                                <p class="text-muted text-center" id="no-notification-message">No notifications yet.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- REQUEST SECTION -->
                <div class="content-section" id="request-section" style="display: none;">
                     <h5 class="mb-4">Submit a Request</h5>
                     <form action="#" method="post" class="request-form needs-validation" id="request-form" novalidate>
                         <div class="row g-3 mb-3">
                             <div class="col-md-6">
                                 <label for="request-type" class="form-label">Type of Request / Issue</label>
                                 <select class="form-select form-select-sm" id="request-type" name="request_type" required>
                                     <option value="" disabled selected>Select...</option>
                                     <option value="technical_support">Technical Support</option>
                                     <option value="classroom_issue">Classroom Issue</option>
                                     <option value="supplies_request">Supplies Request</option>
                                     <option value="maintenance">Maintenance</option>
                                     <option value="hr_query">HR Query</option>
                                     <option value="other">Other (Specify)</option>
                                 </select>
                                 <div class="invalid-feedback">Please select the type of request.</div>
                                 <div id="other-request-type-display" class="form-text small text-muted mt-1 fst-italic" style="display: none;"></div>
                             </div>
                              <div class="col-md-6">
                                 <label for="priority" class="form-label">Priority Level</label>
                                 <select class="form-select form-select-sm" id="priority" name="priority" required>
                                     <option value="" disabled selected>Select...</option>
                                     <option value="low">Low</option>
                                     <option value="medium">Medium</option>
                                     <option value="high">High</option>
                                     <option value="urgent">Urgent</option>
                                 </select>
                                 <div class="invalid-feedback">Please select a priority level.</div>
                             </div>
                         </div>
                         <div class="row g-3 mb-3">
                             <div class="col-md-12">
                                 <label for="request-title" class="form-label">Request Title / Subject</label>
                                 <input type="text" class="form-control form-control-sm" id="request-title" name="request_title" required>
                                 <div class="invalid-feedback"> Please provide a title or subject for your request.</div>
                             </div>
                         </div>
                         <div class="mb-3">
                             <label for="request-details" class="form-label">Request Details / Description</label>
                             <textarea class="form-control form-control-sm" id="request-details" name="request_details" rows="4" required></textarea>
                             <div class="invalid-feedback">Please provide details about your request.</div>
                         </div>
                         <div class="mb-4">
                             <label for="attachments" class="form-label">Upload Supporting Files or Photos (optional)</label>
                             <input class="form-control form-control-sm" type="file" id="attachments" name="attachments[]" multiple>
                             <div class="form-text small">You can upload multiple files if needed.</div>
                         </div>
                         <div class="form-check mb-4">
                             <input class="form-check-input" type="checkbox" value="" id="terms" name="terms" required>
                             <label class="form-check-label" for="terms">I acknowledge that the information provided is accurate. </label>
                             <div class="invalid-feedback">You must acknowledge before submitting.</div>
                         </div>
                         <div class="mb-3">
                             <button class="btn btn-danger" type="submit">Submit</button>
                             <button class="btn btn-secondary ms-2" type="reset">Clear</button>
                         </div>
                     </form>
                </div>

                <!-- STATUS SECTION -->
                <div class="content-section" id="status-section" style="display: none;">
                    <h5 class="mb-4">Current Request Status</h5>
                    <div class="content-table-header d-none d-md-flex justify-content-between align-items-center mb-3 px-3 py-2">
                         <div class="col-content"><strong>Ticket #</strong></div>
                         <div class="col-content"><strong>Subject</strong></div>
                         <div class="col-content"><strong>Status</strong></div>
                         <div class="col-content"><strong>Updated</strong></div>
                         <div class="col-content" style="flex-basis: 220px; flex-grow: 0;"><strong>Action</strong></div>
                    </div>
                    <div class="status-content mb-4" id="status-content">
                    </div>
                    <div class="text-center py-5" id="no-status-message">
                         <p class="text-muted fs-5 mb-2">Loading requests...</p>
                         <a href="#request-section" class="text-decoration-none link-danger fw-medium nav-link internal-nav"><i class="fas fa-plus-circle me-1"></i>Submit Request Now</a>
                     </div>
                </div>

                <!-- HISTORY SECTION -->
                <div class="content-section" id="history-section" style="display: none;">
                    <h5 class="mb-4">Confirmed & Rejected History</h5>
                    <div class="content-table-container">
                        <div class="content-table-header d-none d-md-flex justify-content-between align-items-center mb-3 px-3 py-2">
                            <div class="col-content"><strong>Ticket #</strong></div>
                            <div class="col-content"><strong>Subject</strong></div>
                            <div class="col-content"><strong>Status</strong></div>
                            <div class="col-content"><strong>Finalized Date</strong></div>
                            <div class="col-content" style="flex-basis: 80px; flex-grow: 0;"><strong>Action</strong></div>
                        </div>
                        <div class="history-content mb-4" id="history-content">
                        </div>
                        <div class="text-center py-5" id="no-history-message">
                            <p class="text-muted fs-5 mb-2">Loading history...</p>
                        </div>
                    </div>
                </div>

                 <!-- SETTINGS SECTION -->
                <div class="content-section" id="settings-section" style="display: none;">
                    <h5 class="mb-4">Settings</h5>
                    <div class="row gy-4">
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h6 class="card-title"><i class="fas fa-user-cog me-2 text-muted"></i>Profile</h6>
                                    <p class="card-text small text-muted">View and manage your profile information.</p>
                                    <button class="btn btn-sm btn-outline-secondary" id="settings-edit-profile-btn">Edit Profile</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div> 
        </div> 
    </div>

    <!-- MODALS -->

    <!-- View Request Details Modal -->
    <div class="modal fade" id="viewRequestModal" tabindex="-1" aria-labelledby="viewRequestModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewRequestModalLabel">Request Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                     <form id="view-request-form">
                        <fieldset class="mb-3 p-3 border rounded">
                            <legend class="fw-bold h6 float-none w-auto px-2 fs-sm">Submitter</legend>
                            <div class="mb-2">
                                <label class="form-label form-label-sm d-block">Submitter Name</label>
                                <input type="text" class="form-control form-control-sm form-control-plaintext ps-1" id="view-submitter-name" readonly>
                            </div>
                        </fieldset>
                        <fieldset class="mb-3 p-3 border rounded">
                            <legend class="fw-bold h6 float-none w-auto px-2 fs-sm">Request Info</legend>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Type</label><input type="text" class="form-control form-control-sm form-control-plaintext ps-1" id="view-request-type" readonly></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Priority</label><input type="text" class="form-control form-control-sm form-control-plaintext ps-1" id="view-priority" readonly></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Subject</label><input type="text" class="form-control form-control-sm form-control-plaintext ps-1" id="view-request-title" readonly></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Details</label><textarea class="form-control form-control-sm form-control-plaintext ps-1" id="view-request-details" rows="4" readonly></textarea></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Attachments</label><div id="view-attachments" class="form-control-plaintext ps-1 text-muted"></div></div>
                        </fieldset>
                        <fieldset class="mb-1 p-3 border rounded">
                            <legend class="fw-bold h6 float-none w-auto px-2 fs-sm">Status & Timeline</legend>
                             <div class="mb-2"><label class="form-label form-label-sm d-block">Ticket #</label><p id="view-ticket-id" class="form-control-plaintext ps-1 mb-0"></p></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Status</label><div id="view-status" class="fw-bold ps-1"></div></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Submitted</label><p id="view-submitted" class="form-control-plaintext ps-1 mb-0"></p></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Last Updated</label><p id="view-last-updated" class="form-control-plaintext ps-1 mb-0"></p></div>
                            <div class="mb-2"><label class="form-label form-label-sm d-block">Completed/Rejected Date</label><p id="view-completed" class="form-control-plaintext ps-1 mb-0"></p></div>
                            <div class="mb-2" id="view-notes-row" style="display: none;"><label class="form-label form-label-sm d-block">Notes / Report</label><textarea class="form-control form-control-sm form-control-plaintext ps-1" id="view-notes" rows="3" readonly></textarea></div>
                        </fieldset>
                    </form>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button></div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                 <div class="modal-header"><h5 class="modal-title" id="confirmationModalLabel">Confirm</h5></div>
                <div class="modal-body" id="confirmationModalBody"></div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button><button type="button" class="btn btn-danger" id="confirmActionButton">Confirm</button></div>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div class="modal fade" id="userProfileModal" tabindex="-1" aria-labelledby="userProfileModalLabel" aria-hidden="true">
         <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userProfileModalLabel">User Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-profile-form" class="needs-validation" novalidate>
                        <div class="row">
                            <div class="col-md-4 text-center mb-3 mb-md-0">
                                <img src="placeholder-profile.png" alt="Profile Picture" id="profile-picture-preview" class="rounded-circle mb-2" width="120" height="120" style="object-fit: cover; border: 2px solid #ccc;">
                                <i class="fas fa-user-circle fs-1 text-secondary" id="profile-icon-placeholder-edit" style="display: none; font-size: 120px !important;"></i>
                                <div>
                                    <label for="profile-picture-input" class="btn btn-sm btn-outline-secondary mt-2">
                                        <i class="fas fa-camera me-1"></i> Change Photo
                                    </label>
                                    <input type="file" id="profile-picture-input" accept="image/*" style="display: none;">
                                    <button type="button" id="remove-profile-picture-btn" class="btn btn-sm btn-outline-danger mt-2 ms-1" title="Remove Photo">
                                         <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                                 <small class="text-muted d-block mt-1">Max 2MB. JPG, PNG, GIF</small>
                                 <input type="hidden" id="profile-picture-base64">
                            </div>

                            <div class="col-md-8">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="profile-edit-firstname" class="form-label form-label-sm">First Name <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="profile-edit-firstname" required>
                                        <div class="invalid-feedback">First name is required.</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="profile-edit-lastname" class="form-label form-label-sm">Last Name <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control form-control-sm" id="profile-edit-lastname" required>
                                         <div class="invalid-feedback">Last name is required.</div>
                                    </div>
                                     <div class="col-md-6">
                                        <label for="profile-edit-middlename" class="form-label form-label-sm">Middle Name</label>
                                        <input type="text" class="form-control form-control-sm" id="profile-edit-middlename">
                                    </div>
                                     <div class="col-md-6">
                                        <label for="profile-edit-suffix" class="form-label form-label-sm">Suffix</label>
                                        <input type="text" class="form-control form-control-sm" id="profile-edit-suffix">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="profile-edit-email" class="form-label form-label-sm">Email <span class="text-danger">*</span></label>
                                        <input type="email" class="form-control form-control-sm" id="profile-edit-email" required>
                                        <div class="invalid-feedback">Please enter a valid email.</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="profile-edit-phone" class="form-label form-label-sm">Contact Number</label>
                                        <input type="tel" class="form-control form-control-sm" id="profile-edit-phone" placeholder="e.g., 09123456789">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="profile-edit-employee-id" class="form-label form-label-sm">Employee ID</label>
                                        <input type="text" class="form-control-plaintext form-control-sm" id="profile-edit-employee-id" readonly>
                                    </div>
                                    <div class="col-md-6">
                                         <label for="profile-edit-college" class="form-label form-label-sm">College / Department</label>
                                         <input type="text" class="form-control-plaintext form-control-sm" id="profile-edit-college" readonly>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="profile-edit-position" class="form-label form-label-sm">Position</label>
                                        <input type="text" class="form-control-plaintext form-control-sm" id="profile-edit-position" readonly>
                                    </div>
                                </div>

                                <div class="row g-3 mt-3 border-top pt-3" id="profile-password-section">
                                    <h6 class="text-muted mb-2">Change Password (Optional)</h6>
                                     <div class="col-md-6">
                                        <label for="profile-edit-new-password" class="form-label form-label-sm">New Password</label>
                                        <input type="password" class="form-control form-control-sm" id="profile-edit-new-password" aria-describedby="passwordHelpBlock">
                                        <div class="invalid-feedback" id="new-password-feedback"></div>
                                    </div>
                                     <div class="col-md-6">
                                        <label for="profile-edit-confirm-password" class="form-label form-label-sm">Confirm New Password</label>
                                        <input type="password" class="form-control form-control-sm" id="profile-edit-confirm-password">
                                        <div class="invalid-feedback" id="confirm-password-feedback">Passwords do not match.</div>
                                    </div>
                                    <div id="passwordHelpBlock" class="form-text">
                                      Leave blank to keep your current password. If changing, ensure passwords match.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="cancel-profile-btn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-profile-btn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1100">
    </div>

    <!-- Cancellation Reason Modal -->
    <div class="modal fade" id="cancelReasonModal" tabindex="-1" aria-labelledby="cancelReasonModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                 <div class="modal-header">
                    <h5 class="modal-title" id="cancelReasonModalLabel">Confirm Cancellation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="cancel-confirmation-text">Are you sure you want to cancel this request?</p>
                    <div class="mb-3">
                        <label for="cancel-reason-input" class="form-label">Reason for cancellation (optional):</label>
                        <textarea class="form-control form-control-sm" id="cancel-reason-input" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-warning text-dark" id="confirmCancelWithReasonBtn">Confirm Cancellation</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Issue Modal -->
    <div class="modal fade" id="reportIssueModal" tabindex="-1" aria-labelledby="reportIssueModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                 <div class="modal-header">
                    <h5 class="modal-title" id="reportIssueModalLabel">Report Issue with Request #<span id="report-request-id-display"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="report-issue-form" class="needs-validation" novalidate>
                        <input type="hidden" id="report-request-id-input">
                        <p>Please describe the issue you encountered with the resolution of this request.</p>
                        <div class="mb-3">
                            <label for="report-comments" class="form-label">Issue Details / Comments <span class="text-danger">*</span></label>
                            <textarea class="form-control form-control-sm" id="report-comments" rows="4" required></textarea>
                            <div class="invalid-feedback">Please provide details about the issue.</div>
                        </div>
                        <div class="mb-3">
                            <label for="report-attachments" class="form-label">Upload Supporting Files or Photos (optional)</label>
                            <input class="form-control form-control-sm" type="file" id="report-attachments" name="report_attachments[]" multiple>
                            <div class="form-text small">You can upload multiple files if needed.</div>
                        </div>
                         <div class="form-check mb-3">
                             <input class="form-check-input" type="checkbox" value="" id="report-terms" name="report_terms" required>
                             <label class="form-check-label" for="report-terms">I confirm the reported issue is accurate. <span class="text-danger">*</span></label>
                             <div class="invalid-feedback">You must acknowledge before submitting the report.</div>
                         </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="submitReportBtn">Submit Report</button>
                </div>
            </div>
        </div>
    </div>

    <!-- "Other" Request Type Modal -->
    <div class="modal fade" id="otherRequestTypeModal" tabindex="-1" aria-labelledby="otherRequestTypeModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                 <div class="modal-header">
                    <h5 class="modal-title" id="otherRequestTypeModalLabel">Specify Request Type</h5>
                </div>
                <div class="modal-body">
                    <p>Please specify the type of request or issue:</p>
                    <div class="mb-3">
                        <label for="other-request-type-input" class="form-label visually-hidden">Specify Type</label>
                        <input type="text" class="form-control form-control-sm" id="other-request-type-input" placeholder="e.g., Website Update, Event Setup" required>
                        <div class="invalid-feedback">Please specify the request type.</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelOtherRequestTypeBtn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirmOtherRequestTypeBtn">Confirm Type</button>
                </div>
            </div>
        </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="SCRIPT/userScript.js"></script>
</body>
</html>
